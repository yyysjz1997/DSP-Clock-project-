#include "lcd.h"

Uint16 BACK_COLOR, POINT_COLOR;

const unsigned char asc2_1608[][16] = { { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 },/*" ",0*/
{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1F, 0xCC, 0x00, 0x0C, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00 },/*"!",1*/
{ 0x00, 0x00, 0x08, 0x00, 0x30, 0x00, 0x60, 0x00, 0x08, 0x00, 0x30, 0x00, 0x60,
		0x00, 0x00, 0x00 },/*""",2*/
{ 0x02, 0x20, 0x03, 0xFC, 0x1E, 0x20, 0x02, 0x20, 0x03, 0xFC, 0x1E, 0x20, 0x02,
		0x20, 0x00, 0x00 },/*"#",3*/
{ 0x00, 0x00, 0x0E, 0x18, 0x11, 0x04, 0x3F, 0xFF, 0x10, 0x84, 0x0C, 0x78, 0x00,
		0x00, 0x00, 0x00 },/*"$",4*/
{ 0x0F, 0x00, 0x10, 0x84, 0x0F, 0x38, 0x00, 0xC0, 0x07, 0x78, 0x18, 0x84, 0x00,
		0x78, 0x00, 0x00 },/*"%",5*/
{ 0x00, 0x78, 0x0F, 0x84, 0x10, 0xC4, 0x11, 0x24, 0x0E, 0x98, 0x00, 0xE4, 0x00,
		0x84, 0x00, 0x08 },/*"&",6*/
{ 0x08, 0x00, 0x68, 0x00, 0x70, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00 },/*"'",7*/
{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x07, 0xE0, 0x18, 0x18, 0x20, 0x04, 0x40,
		0x02, 0x00, 0x00 },/*"(",8*/
{ 0x00, 0x00, 0x40, 0x02, 0x20, 0x04, 0x18, 0x18, 0x07, 0xE0, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00 },/*")",9*/
{ 0x02, 0x40, 0x02, 0x40, 0x01, 0x80, 0x0F, 0xF0, 0x01, 0x80, 0x02, 0x40, 0x02,
		0x40, 0x00, 0x00 },/*"*",10*/
{ 0x00, 0x80, 0x00, 0x80, 0x00, 0x80, 0x0F, 0xF8, 0x00, 0x80, 0x00, 0x80, 0x00,
		0x80, 0x00, 0x00 },/*"+",11*/
{ 0x00, 0x01, 0x00, 0x0D, 0x00, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00 },/*",",12*/
{ 0x00, 0x00, 0x00, 0x80, 0x00, 0x80, 0x00, 0x80, 0x00, 0x80, 0x00, 0x80, 0x00,
		0x80, 0x00, 0x80 },/*"-",13*/
{ 0x00, 0x00, 0x00, 0x0C, 0x00, 0x0C, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00 },/*".",14*/
{ 0x00, 0x00, 0x00, 0x06, 0x00, 0x18, 0x00, 0x60, 0x01, 0x80, 0x06, 0x00, 0x18,
		0x00, 0x20, 0x00 },/*"/",15*/
{ 0x00, 0x00, 0x07, 0xF0, 0x08, 0x08, 0x10, 0x04, 0x10, 0x04, 0x08, 0x08, 0x07,
		0xF0, 0x00, 0x00 },/*"0",16*/
{ 0x00, 0x00, 0x08, 0x04, 0x08, 0x04, 0x1F, 0xFC, 0x00, 0x04, 0x00, 0x04, 0x00,
		0x00, 0x00, 0x00 },/*"1",17*/
{ 0x00, 0x00, 0x0E, 0x0C, 0x10, 0x14, 0x10, 0x24, 0x10, 0x44, 0x11, 0x84, 0x0E,
		0x0C, 0x00, 0x00 },/*"2",18*/
{ 0x00, 0x00, 0x0C, 0x18, 0x10, 0x04, 0x11, 0x04, 0x11, 0x04, 0x12, 0x88, 0x0C,
		0x70, 0x00, 0x00 },/*"3",19*/
{ 0x00, 0x00, 0x00, 0xE0, 0x03, 0x20, 0x04, 0x24, 0x08, 0x24, 0x1F, 0xFC, 0x00,
		0x24, 0x00, 0x00 },/*"4",20*/
{ 0x00, 0x00, 0x1F, 0x98, 0x10, 0x84, 0x11, 0x04, 0x11, 0x04, 0x10, 0x88, 0x10,
		0x70, 0x00, 0x00 },/*"5",21*/
{ 0x00, 0x00, 0x07, 0xF0, 0x08, 0x88, 0x11, 0x04, 0x11, 0x04, 0x18, 0x88, 0x00,
		0x70, 0x00, 0x00 },/*"6",22*/
{ 0x00, 0x00, 0x1C, 0x00, 0x10, 0x00, 0x10, 0xFC, 0x13, 0x00, 0x1C, 0x00, 0x10,
		0x00, 0x00, 0x00 },/*"7",23*/
{ 0x00, 0x00, 0x0E, 0x38, 0x11, 0x44, 0x10, 0x84, 0x10, 0x84, 0x11, 0x44, 0x0E,
		0x38, 0x00, 0x00 },/*"8",24*/
{ 0x00, 0x00, 0x07, 0x00, 0x08, 0x8C, 0x10, 0x44, 0x10, 0x44, 0x08, 0x88, 0x07,
		0xF0, 0x00, 0x00 },/*"9",25*/
{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x0C, 0x03, 0x0C, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00 },/*":",26*/
{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x01, 0x06, 0x00, 0x00, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00 },/*";",27*/
{ 0x00, 0x00, 0x00, 0x80, 0x01, 0x40, 0x02, 0x20, 0x04, 0x10, 0x08, 0x08, 0x10,
		0x04, 0x00, 0x00 },/*"<",28*/
{ 0x02, 0x20, 0x02, 0x20, 0x02, 0x20, 0x02, 0x20, 0x02, 0x20, 0x02, 0x20, 0x02,
		0x20, 0x00, 0x00 },/*"=",29*/
{ 0x00, 0x00, 0x10, 0x04, 0x08, 0x08, 0x04, 0x10, 0x02, 0x20, 0x01, 0x40, 0x00,
		0x80, 0x00, 0x00 },/*">",30*/
{ 0x00, 0x00, 0x0E, 0x00, 0x12, 0x00, 0x10, 0x0C, 0x10, 0x6C, 0x10, 0x80, 0x0F,
		0x00, 0x00, 0x00 },/*"?",31*/
{ 0x03, 0xE0, 0x0C, 0x18, 0x13, 0xE4, 0x14, 0x24, 0x17, 0xC4, 0x08, 0x28, 0x07,
		0xD0, 0x00, 0x00 },/*"@",32*/
{ 0x00, 0x04, 0x00, 0x3C, 0x03, 0xC4, 0x1C, 0x40, 0x07, 0x40, 0x00, 0xE4, 0x00,
		0x1C, 0x00, 0x04 },/*"A",33*/
{ 0x10, 0x04, 0x1F, 0xFC, 0x11, 0x04, 0x11, 0x04, 0x11, 0x04, 0x0E, 0x88, 0x00,
		0x70, 0x00, 0x00 },/*"B",34*/
{ 0x03, 0xE0, 0x0C, 0x18, 0x10, 0x04, 0x10, 0x04, 0x10, 0x04, 0x10, 0x08, 0x1C,
		0x10, 0x00, 0x00 },/*"C",35*/
{ 0x10, 0x04, 0x1F, 0xFC, 0x10, 0x04, 0x10, 0x04, 0x10, 0x04, 0x08, 0x08, 0x07,
		0xF0, 0x00, 0x00 },/*"D",36*/
{ 0x10, 0x04, 0x1F, 0xFC, 0x11, 0x04, 0x11, 0x04, 0x17, 0xC4, 0x10, 0x04, 0x08,
		0x18, 0x00, 0x00 },/*"E",37*/
{ 0x10, 0x04, 0x1F, 0xFC, 0x11, 0x04, 0x11, 0x00, 0x17, 0xC0, 0x10, 0x00, 0x08,
		0x00, 0x00, 0x00 },/*"F",38*/
{ 0x03, 0xE0, 0x0C, 0x18, 0x10, 0x04, 0x10, 0x04, 0x10, 0x44, 0x1C, 0x78, 0x00,
		0x40, 0x00, 0x00 },/*"G",39*/
{ 0x10, 0x04, 0x1F, 0xFC, 0x10, 0x84, 0x00, 0x80, 0x00, 0x80, 0x10, 0x84, 0x1F,
		0xFC, 0x10, 0x04 },/*"H",40*/
{ 0x00, 0x00, 0x10, 0x04, 0x10, 0x04, 0x1F, 0xFC, 0x10, 0x04, 0x10, 0x04, 0x00,
		0x00, 0x00, 0x00 },/*"I",41*/
{ 0x00, 0x03, 0x00, 0x01, 0x10, 0x01, 0x10, 0x01, 0x1F, 0xFE, 0x10, 0x00, 0x10,
		0x00, 0x00, 0x00 },/*"J",42*/
{ 0x10, 0x04, 0x1F, 0xFC, 0x11, 0x04, 0x03, 0x80, 0x14, 0x64, 0x18, 0x1C, 0x10,
		0x04, 0x00, 0x00 },/*"K",43*/
{ 0x10, 0x04, 0x1F, 0xFC, 0x10, 0x04, 0x00, 0x04, 0x00, 0x04, 0x00, 0x04, 0x00,
		0x0C, 0x00, 0x00 },/*"L",44*/
{ 0x10, 0x04, 0x1F, 0xFC, 0x1F, 0x00, 0x00, 0xFC, 0x1F, 0x00, 0x1F, 0xFC, 0x10,
		0x04, 0x00, 0x00 },/*"M",45*/
{ 0x10, 0x04, 0x1F, 0xFC, 0x0C, 0x04, 0x03, 0x00, 0x00, 0xE0, 0x10, 0x18, 0x1F,
		0xFC, 0x10, 0x00 },/*"N",46*/
{ 0x07, 0xF0, 0x08, 0x08, 0x10, 0x04, 0x10, 0x04, 0x10, 0x04, 0x08, 0x08, 0x07,
		0xF0, 0x00, 0x00 },/*"O",47*/
{ 0x10, 0x04, 0x1F, 0xFC, 0x10, 0x84, 0x10, 0x80, 0x10, 0x80, 0x10, 0x80, 0x0F,
		0x00, 0x00, 0x00 },/*"P",48*/
{ 0x07, 0xF0, 0x08, 0x18, 0x10, 0x24, 0x10, 0x24, 0x10, 0x1C, 0x08, 0x0A, 0x07,
		0xF2, 0x00, 0x00 },/*"Q",49*/
{ 0x10, 0x04, 0x1F, 0xFC, 0x11, 0x04, 0x11, 0x00, 0x11, 0xC0, 0x11, 0x30, 0x0E,
		0x0C, 0x00, 0x04 },/*"R",50*/
{ 0x00, 0x00, 0x0E, 0x1C, 0x11, 0x04, 0x10, 0x84, 0x10, 0x84, 0x10, 0x44, 0x1C,
		0x38, 0x00, 0x00 },/*"S",51*/
{ 0x18, 0x00, 0x10, 0x00, 0x10, 0x04, 0x1F, 0xFC, 0x10, 0x04, 0x10, 0x00, 0x18,
		0x00, 0x00, 0x00 },/*"T",52*/
{ 0x10, 0x00, 0x1F, 0xF8, 0x10, 0x04, 0x00, 0x04, 0x00, 0x04, 0x10, 0x04, 0x1F,
		0xF8, 0x10, 0x00 },/*"U",53*/
{ 0x10, 0x00, 0x1E, 0x00, 0x11, 0xE0, 0x00, 0x1C, 0x00, 0x70, 0x13, 0x80, 0x1C,
		0x00, 0x10, 0x00 },/*"V",54*/
{ 0x1F, 0xC0, 0x10, 0x3C, 0x00, 0xE0, 0x1F, 0x00, 0x00, 0xE0, 0x10, 0x3C, 0x1F,
		0xC0, 0x00, 0x00 },/*"W",55*/
{ 0x10, 0x04, 0x18, 0x0C, 0x16, 0x34, 0x01, 0xC0, 0x01, 0xC0, 0x16, 0x34, 0x18,
		0x0C, 0x10, 0x04 },/*"X",56*/
{ 0x10, 0x00, 0x1C, 0x00, 0x13, 0x04, 0x00, 0xFC, 0x13, 0x04, 0x1C, 0x00, 0x10,
		0x00, 0x00, 0x00 },/*"Y",57*/
{ 0x08, 0x04, 0x10, 0x1C, 0x10, 0x64, 0x10, 0x84, 0x13, 0x04, 0x1C, 0x04, 0x10,
		0x18, 0x00, 0x00 },/*"Z",58*/
{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7F, 0xFE, 0x40, 0x02, 0x40, 0x02, 0x40,
		0x02, 0x00, 0x00 },/*"[",59*/
{ 0x00, 0x00, 0x30, 0x00, 0x0C, 0x00, 0x03, 0x80, 0x00, 0x60, 0x00, 0x1C, 0x00,
		0x03, 0x00, 0x00 },/*"\",60*/
{ 0x00, 0x00, 0x40, 0x02, 0x40, 0x02, 0x40, 0x02, 0x7F, 0xFE, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00 },/*"]",61*/
{ 0x00, 0x00, 0x00, 0x00, 0x20, 0x00, 0x40, 0x00, 0x40, 0x00, 0x40, 0x00, 0x20,
		0x00, 0x00, 0x00 },/*"^",62*/
{ 0x00, 0x01, 0x00, 0x01, 0x00, 0x01, 0x00, 0x01, 0x00, 0x01, 0x00, 0x01, 0x00,
		0x01, 0x00, 0x01 },/*"_",63*/
{ 0x00, 0x00, 0x40, 0x00, 0x40, 0x00, 0x20, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00 },/*"`",64*/
{ 0x00, 0x00, 0x00, 0x98, 0x01, 0x24, 0x01, 0x44, 0x01, 0x44, 0x01, 0x44, 0x00,
		0xFC, 0x00, 0x04 },/*"a",65*/
{ 0x10, 0x00, 0x1F, 0xFC, 0x00, 0x88, 0x01, 0x04, 0x01, 0x04, 0x00, 0x88, 0x00,
		0x70, 0x00, 0x00 },/*"b",66*/
{ 0x00, 0x00, 0x00, 0x70, 0x00, 0x88, 0x01, 0x04, 0x01, 0x04, 0x01, 0x04, 0x00,
		0x88, 0x00, 0x00 },/*"c",67*/
{ 0x00, 0x00, 0x00, 0x70, 0x00, 0x88, 0x01, 0x04, 0x01, 0x04, 0x11, 0x08, 0x1F,
		0xFC, 0x00, 0x04 },/*"d",68*/
{ 0x00, 0x00, 0x00, 0xF8, 0x01, 0x44, 0x01, 0x44, 0x01, 0x44, 0x01, 0x44, 0x00,
		0xC8, 0x00, 0x00 },/*"e",69*/
{ 0x00, 0x00, 0x01, 0x04, 0x01, 0x04, 0x0F, 0xFC, 0x11, 0x04, 0x11, 0x04, 0x11,
		0x00, 0x18, 0x00 },/*"f",70*/
{ 0x00, 0x00, 0x00, 0xD6, 0x01, 0x29, 0x01, 0x29, 0x01, 0x29, 0x01, 0xC9, 0x01,
		0x06, 0x00, 0x00 },/*"g",71*/
{ 0x10, 0x04, 0x1F, 0xFC, 0x00, 0x84, 0x01, 0x00, 0x01, 0x00, 0x01, 0x04, 0x00,
		0xFC, 0x00, 0x04 },/*"h",72*/
{ 0x00, 0x00, 0x01, 0x04, 0x19, 0x04, 0x19, 0xFC, 0x00, 0x04, 0x00, 0x04, 0x00,
		0x00, 0x00, 0x00 },/*"i",73*/
{ 0x00, 0x00, 0x00, 0x03, 0x00, 0x01, 0x01, 0x01, 0x19, 0x01, 0x19, 0xFE, 0x00,
		0x00, 0x00, 0x00 },/*"j",74*/
{ 0x10, 0x04, 0x1F, 0xFC, 0x00, 0x24, 0x00, 0x40, 0x01, 0xB4, 0x01, 0x0C, 0x01,
		0x04, 0x00, 0x00 },/*"k",75*/
{ 0x00, 0x00, 0x10, 0x04, 0x10, 0x04, 0x1F, 0xFC, 0x00, 0x04, 0x00, 0x04, 0x00,
		0x00, 0x00, 0x00 },/*"l",76*/
{ 0x01, 0x04, 0x01, 0xFC, 0x01, 0x04, 0x01, 0x00, 0x01, 0xFC, 0x01, 0x04, 0x01,
		0x00, 0x00, 0xFC },/*"m",77*/
{ 0x01, 0x04, 0x01, 0xFC, 0x00, 0x84, 0x01, 0x00, 0x01, 0x00, 0x01, 0x04, 0x00,
		0xFC, 0x00, 0x04 },/*"n",78*/
{ 0x00, 0x00, 0x00, 0xF8, 0x01, 0x04, 0x01, 0x04, 0x01, 0x04, 0x01, 0x04, 0x00,
		0xF8, 0x00, 0x00 },/*"o",79*/
{ 0x01, 0x01, 0x01, 0xFF, 0x00, 0x85, 0x01, 0x04, 0x01, 0x04, 0x00, 0x88, 0x00,
		0x70, 0x00, 0x00 },/*"p",80*/
{ 0x00, 0x00, 0x00, 0x70, 0x00, 0x88, 0x01, 0x04, 0x01, 0x04, 0x01, 0x05, 0x01,
		0xFF, 0x00, 0x01 },/*"q",81*/
{ 0x01, 0x04, 0x01, 0x04, 0x01, 0xFC, 0x00, 0x84, 0x01, 0x04, 0x01, 0x00, 0x01,
		0x80, 0x00, 0x00 },/*"r",82*/
{ 0x00, 0x00, 0x00, 0xCC, 0x01, 0x24, 0x01, 0x24, 0x01, 0x24, 0x01, 0x24, 0x01,
		0x98, 0x00, 0x00 },/*"s",83*/
{ 0x00, 0x00, 0x01, 0x00, 0x01, 0x00, 0x07, 0xF8, 0x01, 0x04, 0x01, 0x04, 0x00,
		0x00, 0x00, 0x00 },/*"t",84*/
{ 0x01, 0x00, 0x01, 0xF8, 0x00, 0x04, 0x00, 0x04, 0x00, 0x04, 0x01, 0x08, 0x01,
		0xFC, 0x00, 0x04 },/*"u",85*/
{ 0x01, 0x00, 0x01, 0x80, 0x01, 0x70, 0x00, 0x0C, 0x00, 0x10, 0x01, 0x60, 0x01,
		0x80, 0x01, 0x00 },/*"v",86*/
{ 0x01, 0xF0, 0x01, 0x0C, 0x00, 0x30, 0x01, 0xC0, 0x00, 0x30, 0x01, 0x0C, 0x01,
		0xF0, 0x01, 0x00 },/*"w",87*/
{ 0x00, 0x00, 0x01, 0x04, 0x01, 0x8C, 0x00, 0x74, 0x01, 0x70, 0x01, 0x8C, 0x01,
		0x04, 0x00, 0x00 },/*"x",88*/
{ 0x01, 0x01, 0x01, 0x81, 0x01, 0x71, 0x00, 0x0E, 0x00, 0x18, 0x01, 0x60, 0x01,
		0x80, 0x01, 0x00 },/*"y",89*/
{ 0x00, 0x00, 0x01, 0x84, 0x01, 0x0C, 0x01, 0x34, 0x01, 0x44, 0x01, 0x84, 0x01,
		0x0C, 0x00, 0x00 },/*"z",90*/
{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x3E, 0xFC, 0x40,
		0x02, 0x40, 0x02 },/*"{",91*/
{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFF, 0xFF, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00 },/*"|",92*/
{ 0x00, 0x00, 0x40, 0x02, 0x40, 0x02, 0x3E, 0xFC, 0x01, 0x00, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00 },/*"}",93*/
{ 0x00, 0x00, 0x60, 0x00, 0x80, 0x00, 0x80, 0x00, 0x40, 0x00, 0x40, 0x00, 0x20,
		0x00, 0x20, 0x00 }, /*"~",94*/
};

void delayms(Uint16 count)  //delay 1ms
{
	int i, j;
	for (i = 0; i < count; i++)
		for (j = 0; j < 1000; j++)
			;
}
void showimage2(Uint8 *p, Uint8 x, Uint8 y, Uint8 width, Uint8 height) {
	int i, j;
//	Address_set(x, y, x+width-1, y+height-1);
	for (i = 0; i < height; i++) {
		for (j = 0; j < width; j++) {
			POINT_COLOR = *p++;
//			Address_set(x+j, y+i, x+j, y+i);
//			LCD_WR_DATA8(*p++);
			LCD_DrawPoint(2 * j + x, 2 * i + y);
		}
	}
}
//void showimage(Uint8 *p) {
//	int i, j, k;
//	Uint8 picH, picL;
//	for (k = 0; k < 8; k++) {
//		for (j = 0; j < 6; j++) {
//			Address_set(40 * j, 40 * k, 40 * j + 39, 40 * k + 39);
//			for (i = 0; i < 1600; i++) {
//				LCD_WR_DATA8(p[i * 2 + 1]);
//				LCD_WR_DATA8(p[i * 2]);
//			}
//		}
//	}
//	for (k = 0; k < 3; k++) {
//		for (j = 0; j < 3; j++) {
//			Address_set(40 * j, 40 * k, 40 * j + 39, 40 * k + 39);		//鍧愭爣璁剧疆
//			for (i = 0; i < 40 * 40; i++) {
//				picL = *(p + i * 2);	//鏁版嵁浣庝綅鍦ㄥ墠
//				picH = *(p + i * 2 + 1);
//				LCD_WR_DATA(picL);
//				LCD_WR_DATA(picH);
//			}
//		}
//	}
//}

//void xianshi() {
//	showhanzi(100, 200, 0);
//	showhanzi(200, 200, 1);
//}
//
//void showhanzi(unsigned int x, unsigned int y, unsigned char index) {
//	unsigned char i, j;
//	unsigned char *temp = hanzi;
//	Address_set(x, y, x + 31, y + 31);
//	temp += index * 128;
//	for (j = 0; j < 128; j++) {
//		for (i = 0; i < 8; i++) {
//			if ((*temp & (1 << i)) != 0) {
//				LCD_WR_DATA(POINT_COLOR);
//			} else {
//				LCD_WR_DATA(BACK_COLOR);
//			}
//		}
//		temp++;
//	}
//}

void LCD_Writ_Bus(Uint8 Data) {
	unsigned char i = 0;
	for (i = 8; i > 0; i--) {
		if (Data & 0x80)
			LCD_SDA_SET();
		else
			LCD_SDA_CLR();
		LCD_SCL_CLR();
		LCD_SCL_SET();
		Data <<= 1;
	}
}

void LCD_WR_DATA8(Uint8 da) {
	LCD_DC_SET();
	LCD_Writ_Bus(da);
}

void LCD_WR_DATA(Uint16 Data) {
	LCD_DC_SET();
	LCD_Writ_Bus(Data >> 8);
	LCD_Writ_Bus(Data);
}
void LCD_WR_REG(Uint8 Index) {
	LCD_DC_CLR();
	LCD_Writ_Bus(Index);
}
void LCD_WR_REG_DATA(Uint8 Index, Uint16 Data) {
	LCD_WR_REG(Index);
	LCD_WR_DATA(Data);
}
void Address_set(Uint8 x1, Uint8 y1, Uint8 x2, Uint8 y2) {
	LCD_WR_REG(0x2a);
	LCD_WR_DATA8(x1 >> 8);
	LCD_WR_DATA8(x1);
	LCD_WR_DATA8(x2 >> 8);
	LCD_WR_DATA8(x2);

	LCD_WR_REG(0x2b);
	LCD_WR_DATA8(y1 >> 8);
	LCD_WR_DATA8(y1);
	LCD_WR_DATA8(y2 >> 8);
	LCD_WR_DATA8(y2);

	LCD_WR_REG(0x2C);
}

void InitLCDGpio(void) {
	/*******LCD 18,19,29,34,A6********************/
	EALLOW;
	GpioCtrlRegs.GPAMUX2.bit.GPIO16 = 0;
	GpioCtrlRegs.GPAMUX2.bit.GPIO17 = 0;
	GpioCtrlRegs.GPAMUX2.bit.GPIO18 = 0;
	GpioCtrlRegs.GPAMUX2.bit.GPIO19 = 0;
	GpioCtrlRegs.GPAMUX2.bit.GPIO29 = 0;
	GpioCtrlRegs.GPBMUX1.bit.GPIO34 = 0;
	GpioCtrlRegs.GPADIR.bit.GPIO16 = 1;
	GpioCtrlRegs.GPADIR.bit.GPIO17 = 1;
	GpioCtrlRegs.GPADIR.bit.GPIO18 = 1;
	GpioCtrlRegs.GPADIR.bit.GPIO19 = 1;
	GpioCtrlRegs.GPADIR.bit.GPIO29 = 1;
	GpioCtrlRegs.GPBDIR.bit.GPIO34 = 1;
	GpioCtrlRegs.AIOMUX1.bit.AIO6 = 0;
	GpioCtrlRegs.AIODIR.bit.AIO6 = 1;
	EDIS;
}
void Lcd_Init(void) {
	InitLCDGpio();
	LCD_CS_SET();

	LCD_RST_CLR();
	delayms(20);
	LCD_RST_SET();
	delayms(20);
	LCD_CS_CLR();

	LCD_WR_REG(0xCB);
	LCD_WR_DATA8(0x39);
	LCD_WR_DATA8(0x2C);
	LCD_WR_DATA8(0x00);
	LCD_WR_DATA8(0x34);
	LCD_WR_DATA8(0x02);

	LCD_WR_REG(0xCF);
	LCD_WR_DATA8(0x00);
	LCD_WR_DATA8(0XC1);
	LCD_WR_DATA8(0X30);

	LCD_WR_REG(0xE8);
	LCD_WR_DATA8(0x85);
	LCD_WR_DATA8(0x00);
	LCD_WR_DATA8(0x78);

	LCD_WR_REG(0xEA);
	LCD_WR_DATA8(0x00);
	LCD_WR_DATA8(0x00);

	LCD_WR_REG(0xED);
	LCD_WR_DATA8(0x64);
	LCD_WR_DATA8(0x03);
	LCD_WR_DATA8(0X12);
	LCD_WR_DATA8(0X81);

	LCD_WR_REG(0xF7);
	LCD_WR_DATA8(0x20);

	LCD_WR_REG(0xC0);    //Power control
	LCD_WR_DATA8(0x23);   //VRH[5:0]

	LCD_WR_REG(0xC1);    //Power control
	LCD_WR_DATA8(0x10);   //SAP[2:0];BT[3:0]

	LCD_WR_REG(0xC5);    //VCM control
	LCD_WR_DATA8(0x3e);
	LCD_WR_DATA8(0x28);

	LCD_WR_REG(0xC7);    //VCM control2
	LCD_WR_DATA8(0x86);  //--

	LCD_WR_REG(0x36);    // Memory Access Control
	LCD_WR_DATA8(0x48); //C8

	LCD_WR_REG(0x3A);
	LCD_WR_DATA8(0x55);

	LCD_WR_REG(0xB1);
	LCD_WR_DATA8(0x00);
	LCD_WR_DATA8(0x18);

	LCD_WR_REG(0xB6);    // Display Function Control
	LCD_WR_DATA8(0x08);
	LCD_WR_DATA8(0x82);
	LCD_WR_DATA8(0x27);

	LCD_WR_REG(0xF2);    // 3Gamma Function Disable
	LCD_WR_DATA8(0x00);

	LCD_WR_REG(0x26);    //Gamma curve selected
	LCD_WR_DATA8(0x01);

	LCD_WR_REG(0xE0);    //Set Gamma
	LCD_WR_DATA8(0x0F);
	LCD_WR_DATA8(0x31);
	LCD_WR_DATA8(0x2B);
	LCD_WR_DATA8(0x0C);
	LCD_WR_DATA8(0x0E);
	LCD_WR_DATA8(0x08);
	LCD_WR_DATA8(0x4E);
	LCD_WR_DATA8(0xF1);
	LCD_WR_DATA8(0x37);
	LCD_WR_DATA8(0x07);
	LCD_WR_DATA8(0x10);
	LCD_WR_DATA8(0x03);
	LCD_WR_DATA8(0x0E);
	LCD_WR_DATA8(0x09);
	LCD_WR_DATA8(0x00);

	LCD_WR_REG(0XE1);    //Set Gamma
	LCD_WR_DATA8(0x00);
	LCD_WR_DATA8(0x0E);
	LCD_WR_DATA8(0x14);
	LCD_WR_DATA8(0x03);
	LCD_WR_DATA8(0x11);
	LCD_WR_DATA8(0x07);
	LCD_WR_DATA8(0x31);
	LCD_WR_DATA8(0xC1);
	LCD_WR_DATA8(0x48);
	LCD_WR_DATA8(0x08);
	LCD_WR_DATA8(0x0F);
	LCD_WR_DATA8(0x0C);
	LCD_WR_DATA8(0x31);
	LCD_WR_DATA8(0x36);
	LCD_WR_DATA8(0x0F);

	LCD_WR_REG(0x11);    //Exit Sleep
	delayms(120);

	LCD_WR_REG(0x29);    //Display on
	LCD_WR_REG(0x2c);
}

void LCD_Clear(Uint16 Color) {
	Uint8 VH, VL;
	Uint16 i, j;
	VH = Color >> 8;
	VL = Color;
	Address_set(0, 0, LCD_W - 1, LCD_H - 1);
	for (i = 0; i < LCD_W; i++) {
		for (j = 0; j < LCD_H; j++) {
			LCD_WR_DATA8(VH);
			LCD_WR_DATA8(VL);
		}
	}
	BACK_COLOR = Color;
}

void LCD_DrawPoint(Uint16 x, Uint16 y) {
	Address_set(x, y, x, y);
	LCD_WR_DATA(POINT_COLOR);
}

void LCD_Fill(Uint16 xsta, Uint16 ysta, Uint16 xend, Uint16 yend, Uint16 color) {
	Uint16 i, j;
	Address_set(xsta, ysta, xend, yend);
	for (i = ysta; i <= yend; i++) {
		for (j = xsta; j <= xend; j++)
			LCD_WR_DATA(color);
	}
}

void LCD_DrawPoint_big(Uint16 x, Uint16 y) {
	LCD_Fill(x - 1, y - 1, x + 1, y + 1, POINT_COLOR);
}

void LCD_DrawLine(Uint16 x1, Uint16 y1, Uint16 x2, Uint16 y2) {
	Uint16 t;
	int xerr = 0, yerr = 0, delta_x, delta_y, distance;
	int incx, incy, uRow, uCol;

	delta_x = x2 - x1;
	delta_y = y2 - y1;
	uRow = x1;
	uCol = y1;
	if (delta_x > 0)
		incx = 1;
	else if (delta_x == 0)
		incx = 0;
	else {
		incx = -1;
		delta_x = -delta_x;
	}
	if (delta_y > 0)
		incy = 1;
	else if (delta_y == 0)
		incy = 0;
	else {
		incy = -1;
		delta_y = -delta_y;
	}
	if (delta_x > delta_y)
		distance = delta_x;
	else
		distance = delta_y;
	for (t = 0; t <= distance + 1; t++) {
		LCD_DrawPoint(uRow, uCol);
		xerr += delta_x;
		yerr += delta_y;
		if (xerr > distance) {
			xerr -= distance;
			uRow += incx;
		}
		if (yerr > distance) {
			yerr -= distance;
			uCol += incy;
		}
	}
}

void LCD_DrawRectangle(Uint16 x1, Uint16 y1, Uint16 x2, Uint16 y2) {
	LCD_DrawLine(x1, y1, x2, y1);
	LCD_DrawLine(x1, y1, x1, y2);
	LCD_DrawLine(x1, y2, x2, y2);
	LCD_DrawLine(x2, y1, x2, y2);
}

void Draw_Circle(Uint16 x0, Uint16 y0, Uint8 r) {
	int a, b;
	int di;
	a = 0;
	b = r;
	di = 3 - (r << 1);
	while (a <= b) {
		LCD_DrawPoint(x0 - b, y0 - a);             //3
		LCD_DrawPoint(x0 + b, y0 - a);             //0
		LCD_DrawPoint(x0 - a, y0 + b);             //1
		LCD_DrawPoint(x0 - b, y0 - a);             //7
		LCD_DrawPoint(x0 - a, y0 - b);             //2
		LCD_DrawPoint(x0 + b, y0 + a);             //4
		LCD_DrawPoint(x0 + a, y0 - b);             //5
		LCD_DrawPoint(x0 + a, y0 + b);             //6
		LCD_DrawPoint(x0 - b, y0 + a);
		a++;
		if (di < 0)
			di += 4 * a + 6;
		else {
			di += 10 + 4 * (a - b);
			b--;
		}
		LCD_DrawPoint(x0 + a, y0 + b);
	}
}

void LCD_ShowChar(Uint16 x, Uint16 y, Uint8 num, Uint8 mode) {
	Uint8 temp, t, t1;
	Uint8 y0 = y;
	Uint16 colortemp = POINT_COLOR;
	num = num - ' ';             //寰楀埌鍋忕Щ鍚庣殑鍊�
	for (t = 0; t < 16; t++) {
		temp = asc2_1608[num][t];		 //璋冪敤1608瀛椾綋
		for (t1 = 0; t1 < 8; t1++) {
			if (temp & 0x80)
				POINT_COLOR = colortemp;
			else
				POINT_COLOR = BACK_COLOR;
			LCD_DrawPoint(x, y);
			temp <<= 1;
			y++;
			if ((y - y0) == 16) {
				y = y0;
				x++;
				break;
			}
		}
	}
	POINT_COLOR = colortemp;
}
void LCD_ShowNum(Uint16 x, Uint16 y, Uint32 num, Uint8 len) {
	Uint8 t, temp;
	Uint8 enshow = 0;
	num = (Uint16) num;
	for (t = 0; t < len; t++) {
		temp = (num / mypow(10, len - t - 1)) % 10;
		if (enshow == 0 && t < (len - 1)) {
			if (temp == 0) {
				LCD_ShowChar(x + 8 * t, y, ' ', 0);
				continue;
			} else
				enshow = 1;

		}
		LCD_ShowChar(x + 8 * t, y, temp + 48, 0);
	}
}

Uint32 mypow(Uint8 m, Uint8 n) {
	Uint32 result = 1;
	while (n--)
		result *= m;
	return result;
}
void LCD_Show2Num(Uint16 x, Uint16 y, Uint16 num, Uint8 len) {
	Uint8 t, temp;
	for (t = 0; t < len; t++) {
		temp = (num / mypow(10, len - t - 1)) % 10;
		LCD_ShowChar(x + 8 * t, y, temp + '0', 0);
	}
}

void LCD_ShowString(Uint16 x, Uint16 y, char *p) {
	while (*p != '\0') {
		if (x > LCD_W - 16) {
			x = 0;
			y += 16;
		}
		if (y > LCD_H - 16) {
			y = x = 0;
		}
		LCD_ShowChar(x, y, *p, 0);
		x += 8;
		p++;
	}
}

